---
description: Использование панели «память» для
title: DevTools-Memory
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 03/05/2020
ms.topic: article
ms.prod: microsoft-edge
keywords: Microsoft EDGE, веб-разработка, инструменты для F12, Devtools, память, куча, GC, сборка мусора, сохраненный размер, лидерские стороны
ms.custom: seodec18
ms.openlocfilehash: 416ba144f7e22bd50f5d2a3437bc21d9d31a9035
ms.sourcegitcommit: 6860234c25a8be863b7f29a54838e78e120dbb62
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2020
ms.locfileid: "10571744"
---
# Память

С помощью панели **памяти** можно измерять использование системных ресурсов и сравнивать моментальные снимки кучи в разных состояниях выполнения кода. С его помощью вы можете:

- [Диаграмма потребления памяти страницы в режиме реального времени](#memory-usage-timeline) и создание снимков кучи
- [Определение потенциальных проблем с памятью](#snapshot-summary) в коде, например удержанных объектов, не вложенных в DOM
- [Просмотр данных об использовании памяти](#snapshot-details) с помощью типа объекта, количества экземпляров, размера и ссылок, помогающих изолировать проблемы
- [Примените фильтры данных моментальных снимков](#filters) , чтобы уменьшить шум данных, не связанных с действиями
- [Определение объема памяти для определенного объекта](#object-references) и ссылок для его поддержания активности
- [Сравнение кучи на разных этапах исследования](#snapshot-comparison) для отслеживания источника утечек памяти и других проблем

![Панель DevTools памятью Microsoft Edge](./media/memory.png)


## панель инструментов;

1. **Запуск и остановка сеанса профилирования (Ctrl + E)**: Включение профилировщика позволяет отслеживать использование памяти и создавать снимки кучи.
2. **Импорт сеанса профилирования (Ctrl + O)**: Загрузка сохраненного сеанса диагностики памяти DevTools.
3. **Экспорт сеанса профилирования (Ctrl + S)**: сохранение текущего диагностического сеанса на диске.
4. **Создание снимка кучи (Ctrl + Shift + T)**: запись текущих выделений памяти на данный момент времени.


## Временная шкала использования памяти

Проблемы с памятью могут быть серьезным препятствием проблем с производительностью, что приводит к тому, что ваша страница становится все более недоступной и laggy с течением времени.

Первым шагом для анализа использования памяти на странице является [Запуск сеанса профилирования](#toolbar) для получения моментальных снимков до и после того, как вы воспроизведите этапы, вызывающие чрезмерное использование памяти или вероятную утечку памяти.

При запуске профилировщика памяти появится график обработки памяти, который позволяет наблюдать за общим частным рабочее набором (объем памяти, потребляемый страницей) с течением времени. Граф памяти показывает, как можно просматривать память процесса вкладки, включая закрытые байты, машинную память и кучу JavaScript. 

![Временная шкала использования памяти](./media/memory_timeline.png)

 Диаграмма дает указание о тенденциях памяти для страницы, которая позволяет оценить, когда нужно [получить моментальный снимок кучи](#toolbar) для более позднего сравнения, например, если вы видите точки непредвиденного хранения памяти.

### Performance. Марка ()

Вы можете добавить пользовательские **метки** на временную шкалу, чтобы определить события клавиш во время сеанса анализа, вызвав [`Performance.mark()`](https://developer.mozilla.org/docs/Web/API/Performance/mark) метод из вашего кода или [**консоли**](./console.md)DevTools.

### Console. takeheapSnapshot ()

Иногда необходимо создавать снимки на очень конкретных моментах времени, например непосредственно перед большим изменением DOM. В этих случаях вы можете создавать моментальные снимки программными средствами с помощью [`Console.takeHeapSnapshot()`](./console/console-api.md#taking-heap-snapshots) .

## Сводка по снимкам

Создание [снимка](#toolbar) формирует сводную плитку, указывающую размер кучи JavaScript на момент создания снимка, а также количество выделенных объектов и снимок экрана страницы. Вы можете продолжать делать снимки в любое время, когда вы просматриваете сценарий пользователя, которому требуется выполнить анализ. Снимки создают дополнительные плитки, каждая из которых указывает на разницу в памяти JavaScript из предыдущего снимка.

![Снимок кучи](./media/memory_snapshot.png)

При щелчке значений в плитке "Сводка" будет переключена на область, отображающая [сведения о данных моментальных снимков](#snapshot-details). Потенциальные [проблемы с памятью обозначены](#snapshot-details) синим значком информационного ("i").

## Сведения о снимке

В области " *снимок* " отображаются объекты, созданные на странице, а также все ресурсы, выделенные платформой JavaScript.

![Таблица сведений о снимке](./media/memory_details.png)

Три вкладки представляют различные представления данных:

#### Типы

Показывает количество экземпляров и общий размер объектов в куче, сгруппированных по типам объектов. По умолчанию они сортируются по количеству экземпляров.

Когда вы выберете объект в области " *типы* верхнего уровня", в нижней области в таблице " [ссылки на объекты](#object-references) " будет перечислены все объекты, которые указывают на этот объект.

#### Корней

Показывает иерархическое представление дочерних ссылок для описания того, как объекты находятся в корне глобального объекта, предотвращая их сбор сборщиком мусора.

По умолчанию дочерние узлы сортируются по столбцу сохраненного размера с наибольшим вверху.

#### Лидеры

Показывает список объектов в куче, которые содержат исключительные ссылки на другие объекты. Лидеры сортируются по сохраненному размеру, чтобы обозначить объекты, потребляющие наибольшее объем памяти, который может проще освобождать.

Ниже показано, как интерпретировать столбцы в представлениях *типы, корни* и *лидерства* .

Столбец | Описание
:------------ | :-------------
Идентификатор (-ы) | Имя, которое лучше определяет объект. Например, для HTML-элементов в сведениях о снимке отображается значение атрибута ID, если оно используется.
Тип | Тип объекта (например, *HTMLDivElement*).
Size | Размер объекта, не включая размер объектов, на которые указывает ссылка.
Сохраненный размер | Размер объекта и размер всех дочерних объектов, у которых нет других родителей. Для практических целей это объем памяти, сохраненной объектом, поэтому при удалении объекта, для которого заданный объем памяти освобождается.
Количество | Количество экземпляров объекта. Это значение отображается только в представлении типы.

Когда вы выбираете объект *в верхней области* задач, таблица [ссылки на объекты](#object-references) в нижней области списка будет выделять все объекты, которые указывают на этот объект.

### Фильтру

Для дальнейшей настройки данных в таблице можно выполнить следующие действия:

![Фильтрация для встроенных и идентификаторов объектов](./media/memory_filter.png)

1. **Фильтр идентификатора**: Фильтрация данных с помощью поиска определенного идентификатора объекта
2. **Группировка по лидеру**: только объекты с *монопольными* ссылками на другие объекты отображаются в представлении верхнего уровня объектов (это представление по умолчанию на вкладке " *лидеры* ").
3. **Фильтр встроенных или идентификаторов**: по умолчанию [встроенные объекты JavaScript](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects) включены в список. Список идентификаторов объектов может быть полезен, если существует несколько анонимных объектов, которые должны быть различны.

Каждый из представлений " *типы", "корни* " и " *лидеры* " имеет собственный фильтр, поэтому фильтр не сохраняется при переходе к другому представлению.

### Ссылки на объекты

В представлении " [**типы**](#types) и [**лидеры**](#dominators) " в этой области содержится список **ссылок на объекты** , отображающий общие ссылки. Когда вы выбираете объект в верхней области, в этом списке отображаются все объекты, указывающие на этот объект, иными словами, объекты, которые не поддерживают выбранный объект.

Циклические ссылки отображаются с помощью звездочки (*) и информационных подсказок, и их невозможно развернуть. В противном случае они не позволят вам проанализировать дерево ссылок и идентифицировать объекты, которые сохраняют память.

Чтобы быстро идентифицировать эквивалентные объекты, установите флажок фильтр [*идентификаторов объектов отображения*](#filters) , чтобы отобразить идентификаторы объектов рядом с именами объектов в столбце *идентификаторов* . Объекты с одинаковыми ИДЕНТИФИКАТОРами — это общие ссылки.

### Сравнение снимков

При нажатии на [вкладку "Сравнение снимков"](#snapshot-details) или ссылку "Сравнение" на [плитке сводки снимков](#snapshot-summary) будут показаны сведения о двух снимках. На панели сравнения *лидеры, типы* и *корневые* представления предоставляют те же [*сведения о снимке*](#snapshot-details) , которые вы видите для одного снимка, и эти дополнительные значения:

Столбец | Описание
:------------ | :-------------
Формат различий. | Разница между размером объекта в текущем снимке и его размером в предыдущем снимке, не включая размер объектов, на которые указывает ссылка.
Сохраненный размер различий. | Разница между сохраненным размером объекта в текущем снимке и его сохраненным размером в предыдущем снимке. Сохраненный размер включает в себя размер объекта и его дочерние объекты, у которых нет других родителей. Для практических целей сохраненный размер — это объем памяти, сохраненной объектом, поэтому если вы удалите объект, который освободит заданный объем памяти.

С помощью раскрывающегося списка **область** можно отфильтровать разностные данные между снимками.

![Фильтр областей для comparisions моментальных снимков](./media/memory_comparison_scope_filter.png)

- <strong>Объекты, оставленные на основе снимка # <number></strong> : показывает различие между объектами, добавленными в кучу, и удален из кучи базового снимка в предыдущий снимок. Например, если в сводке по снимкам отображается <em> значение + 205/-195 </em> в счетчике объектов, в этом фильтре будут показаны десять объектов, которые были добавлены, но не удалены.

- <strong>Объекты, добавленные между снимками <number> и # <number></strong> : показывает все объекты, добавленные в кучу из предыдущего снимка.

- <strong>Все объекты в снимке # <number></strong> : показывает все объекты в куче (т. е. в <em> нефильтрованном </em> представлении).

По умолчанию фильтр " *Показать несовпадающие ссылки* " применяется к представлению сравнения для обозначения ссылок на объекты, которые не соответствуют текущему фильтру области. Вы можете отключить его из раскрывающегося меню:

![Фильтр несовпадающих ссылок по сравнению с моментальными снимками](./media/memory_comparison_matching_filter.png)


## Горячие

 Действие | Появивше
:------------ | :-------------
Запуск и остановка сеанса профилирования  | `Ctrl` + `E`
Импорт сеанса профилирования | `Ctrl` + `O`
Экспорт сеанса профилирования | `Ctrl` + `S`
Создание снимка кучи | `Ctrl` + `Shift` + `T`

## Известные проблемы

### Произошла ошибка при запуске сеанса профилирования

Если отображается это сообщение об ошибке: **при запуске сеанса профилирования** в инструменте "память" выполните указанные ниже действия для решения этой проблемы.

1. Нажмите клавишу `Windows Key`  +  `R` .

2. В диалоговом окне Выполнить введите **Services. msc**.
![Известные проблемы – 1](./media/known_issues_1.PNG)

3. Найдите **стандартную службу сборщика центра диагностики Microsoft (R)** и щелкните ее правой кнопкой мыши.
![Известные проблемы – 2](./media/known_issues_2.PNG)

4. Перезапустите **стандартную службу сборщика центра диагностики Microsoft (R)**.
![Известные проблемы – 3](./media/known_issues_3.PNG)

5. Закройте инструменты разработчика Microsoft EDGE и вкладку. Откройте новую вкладку, перейдите на нужную страницу и нажмите клавишу `F12` .

6. Теперь вы сможете начать профилирование. 
![Известные проблемы — 4](./media/known_issues_4-memory.PNG)

Вы по-прежнему столкнулись с проблемами? Пожалуйста, отправьте нам свой отзыв с помощью значка " **Отправить отзыв** "! 

![Известные проблемы – 5](./media/known_issues_5.PNG)
