---
description: Варианты распространения при выпуске приложения с помощью Microsoft Edge WebView2
title: Распространение приложений Microsoft Edge WebView2
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 10/14/2020
ms.topic: conceptual
ms.prod: microsoft-edge
ms.technology: webview
keywords: IWebView2, IWebView2WebView, webview2, WebView, приложения WPF, WPF, EDGE, ICoreWebView2, ICoreWebView2Host, элемент управления "браузер", HTML Edge
ms.openlocfilehash: e96ca2b26feb3883b51ad468db1fabe68ed8ad1f
ms.sourcegitcommit: 61cc15d2fc89aee3e09cec48ef1e0e5bbf8d289a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2020
ms.locfileid: "11118999"
---
# Распространение приложений с помощью WebView2  

При распространении приложения WebView2 перед запуском приложения убедитесь, что веб-платформа, поддерживающая WebView2, присутствует в [среде выполнения](#understanding-the-webview2-runtime) .  В этой статье описано, как разработчики могут установить среду выполнения WebView2 и использовать два режима распространения для вашего приложения WebView2:  [Evergreen](#evergreen-distribution-mode) и [fixed Version](#fixed-version-distribution-mode).  

## Режим распространения Evergreen  

> [!NOTE]
> Для большинства разработчиков рекомендуется использовать режим распространения Evergreen.  

Режим распространения Evergreen гарантирует, что ваше приложение использует последние возможности и обновления для системы безопасности.  Она обладает следующими характеристиками.  

*   Базовая веб-платформа \ (WebView2 (среда выполнения)) обновляется автоматически без дополнительных усилий, предоставленных разработчиками.  
*   Во всех приложениях, использующих режим распространения Evergreen, используется общая копия среды выполнения Evergreen WebView2, что экономит место на диске.  

### Общие сведения о среде выполнения WebView2  

Среда выполнения WebView2 является повторно распространяемой средой выполнения и используется в качестве резервной веб-платформы для приложений WebView2.  Эта концепция похожа на среду выполнения VC + + или .NET для приложений/.NET на C++.  В изнутри среда выполнения изменяет двоичные файлы Microsoft Edge \ (Chromium \), которые настроены и протестированы для приложений.  При установке среда выполнения не отображается в браузере, который является видимым пользователем, например, у пользователей не будет ярлык браузера на рабочем столе или в меню "Пуск".  

Для разработки и тестирования разработчики могут использовать среду выполнения или любой нестабильный канал браузера Microsoft Edge \ (Chromium \) для резервной веб-платформы.  В рабочих средах разработчикам необходимо обеспечить присутствие среды выполнения на устройствах пользователя перед запуском приложения.  Стабильный канал Microsoft Edge недоступен для использования WebView2, чтобы предотвратить получение приложениями зависимости от браузера в производстве.  

Разработчикам не следует использовать зависимость от браузера по следующим причинам:  

*   Microsoft Edge \ (Chromium \) не гарантируется на всех устройствах пользователей.  Например, устройства, отключенные от центра обновления Windows или неуправляемые корпорацией Майкрософт, могут не иметь браузера.  Предоставление разработчикам возможности распространения среды выполнения WebView2 не позволяет использовать зависимость в браузере в качестве предварительных требований для приложений.
*   В браузерах и приложениях используются различные варианты использования, поэтому использование зависимостей в браузере может привести к нежелательным побочным эффектам для приложений.  Например, ИТ-администраторы могут управлять версиями в браузере для обеспечения совместимости внутренних веб-сайтов.  Среда выполнения WebView2 позволяет приложениям оставаться Evergreen, пока обновления браузера активно управляются.  
*   В отличие от браузера, среда выполнения разрабатывается и тестируется для сценариев приложений и в некоторых случаях может включать исправления ошибок, которые еще не доступны в браузере.  

Среда выполнения Evergreen WebView2 планирует отгрузку почты в следующих выпусках Windows.  Перед тем как среда выполнения станет более универсальной, разработчики рекомендуются для развертывания среды выполнения вместе с приложением.  

### Развертывание среды выполнения Evergreen WebView2  

Для всех Evergreen приложений на устройстве требуется только одна установка среды выполнения Evergreen WebView2.  На [странице загрузки среды выполнения WebView2][Webview2Installer] есть ряд инструментов, которые помогают разработчикам развертывать среду выполнения Evergreen, например:  

*   Загрузчик среды выполнения WebView2 \ (для немедленного освобождения) — это крошечный установщик \ (примерно 2 МБ \).  Этот установщик загружает и устанавливает среду выполнения Evergreen на серверах Майкрософт, которые соответствуют архитектуре устройства пользователя.  
*   Ссылка для загрузки загрузчика \ (для немедленного освобождения \) — это ссылка, с помощью которой разработчики могут программно загрузить загрузчик.
*   Автономный установщик среды выполнения WebView2 — это полный установщик, который может установить среду выполнения Evergreen WebView2 в автономных средах.  

В настоящее время загрузчик и автономный установщик поддерживают только установку для компьютера, для которого требуется повышение прав.  При запуске без повышения прав появляется запрос на контроль учетной записи пользователя Windows, с помощью которого пользователи запрашивают разрешения на повышение прав.  

Мы рекомендуем использовать указанные ниже рабочие процессы, чтобы убедиться, что среда выполнения уже установлена перед запуском приложения.  Вы можете настроить рабочий процесс в зависимости от вашего сценария.  Кроме того, мы добавим пример кода в будущем.  

#### Развертывание только в сети  

Если у вас есть сценарий для развертывания только в Интернете, для конечных пользователей требуется доступ к Интернету, выполните указанные ниже действия.  

*   В процессе настройки приложения убедитесь, что среда выполнения уже установлена.  
    *   Проверка наличия RegKey `pv (REG_SZ)` в разделе `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\EdgeUpdate\ClientState\{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}` или  
    *   Вызов API WebView2 [GetAvailableCoreWebView2BrowserVersionString](/microsoft-edge/webview2/reference/win32/webview2-idl#getavailablecorewebview2browserversionstring) и проверка того, имеет ли versionInfo значение null.  
*   Если среда выполнения не установлена, воспользуйтесь ссылкой, чтобы программно загрузить загрузчик.  
*   Вызовите загрузчик из процесса с повышенными привилегиями или командной строки `MicrosoftEdgeWebview2Setup.exe /silent /install` для автоматической установки.  

Этот рабочий процесс гарантирует установку среды выполнения только в том случае, если это необходимо, вы не обязаны упаковывать установщики и определять архитектуру пользователей, а также устанавливать среду выполнения без предупреждения.  Вы также можете выбрать упаковку загрузчика с помощью приложения вместо программной загрузки по запросу.  

#### Развертывание в автономном режиме  

Если вы работаете в автономном режиме, когда развертывание приложения будет работать в автономном режиме, выполните указанные ниже действия.  

*   Скачайте [автономный установщик][Webview2Installer].  
*   Включите установщик в установщик приложения или в средство обновления.  
*   В процессе настройки приложения убедитесь, что среда выполнения уже установлена.  
    *   Проверка наличия RegKey `pv (REG_SZ)` в разделе `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\EdgeUpdate\ClientState\{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}` или  
    *   Вызов API WebView2 [GetAvailableCoreWebView2BrowserVersionString](/microsoft-edge/webview2/reference/win32/webview2-idl#getavailablecorewebview2browserversionstring) и проверка того, имеет ли versionInfo значение null.  
*   Если среда выполнения не установлена, вызовите автономный установщик из процесса с повышенными привилегиями или командной строки `MicrosoftEdgeWebView2RuntimeInstaller{X64/X86/ARM64}.exe /silent /install` для автоматической установки.  

## Режим распространения фиксированной версии  

> [!NOTE]
> Режим распространения фиксированной версии пока недоступен.  

Для ограниченных сред существуют планы поддержки фиксированной версии, ранее названной собственным режимом распространения.  Режим распространения с фиксированной версией позволяет разработчикам выбрать и упаковать определенную версию среды выполнения WebView2.  Режим распространения с фиксированной версией позволяет управлять тем, какая версия среды выполнения WebView2 используется приложением, и при обновлении компьютеров пользователей.  Режим распространения фиксированной версии не получает никаких автоматических обновлений, и разработчики должны планировать применение обновлений самостоятельно.  


<!-- links -->  

[ConceptsVersioning]: ./versioning.md "Общие сведения о версиях браузеров и WebView2 | Документы Microsoft"  

[Webview2Installer]: https://developer.microsoft.com/microsoft-edge/webview2 "Установщик WebView2"  
